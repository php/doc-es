<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision$ -->
<!-- EN-Revision: 7137ccc0fdbf158b97872772dd6a989f32f50365 Maintainer: andresdzphp Status: ready -->
<!-- Reviewed: no -->

 <sect1 xml:id="language.oop5.autoload" xmlns="http://docbook.org/ns/docbook">
  <title>Auto-carga de Clases</title>
  <para>
   Muchos desarrolladores que escriben aplicaciones orientadas a objetos
   crean un archivo fuente PHP para cada definición de clase. Una de las
   mayores molestias es tener que hacer una larga lista de includes
   al comienzo de cada script (uno por cada clase).
  </para>
  <para>
   En PHP 5, esto ya no es más necesario. Se puede definir una función
   __autoload la cual es automáticamente invocada en caso de que esté
   intentando utilizar una clase/interfaz que todavía no haya sido definida.
   Al invocar a esta función el motor de scripting está dando una última
   oportunidad de cargar la clase antes que PHP falle con un error.
  </para>
    <tip>
   <para>
    <function>spl_autoload_register</function> proporciona una alternativa más 
    flexible para la carga automática de clases. Por esta razón, el uso de 
    <function>__autoload</function> no se recomienda y puede ser obsoleta o 
    eliminada en el futuro.
   </para>
  </tip>
  <note>
   <para>
    Antes de 5.3.0, las excepciones lanzadas en la función __autoload no
    podían ser capturadas en el bloque <link linkend="language.exceptions">catch</link>
    y eso resultaba en un error fatal. Desde 5.3.0+ las excepciones lanzadas
    en la función __autoload pueden ser capturadas en el bloque
    <link linkend="language.exceptions">catch</link>, con 1 disposición. Si se
    lanza una excepción personalizada, entonces la clase de excepción personalizada
    debe estar disponible. La función __autoload puede ser usada recursivamente
    para auto-cargar la clase de excepción personalizada.
   </para>
  </note>
  <note>
   <para>
    La auto-carga no está disponible si utiliza PHP en
    <link linkend="features.commandline">modo interactivo</link> CLI.
   </para>
  </note>
  <note>
   <para>
    Si el nombre de la clase es usado, por ejemplo, en <function>call_user_func</function>
    entonces puede contener algunos caracteres peligrosos tal como <literal>../</literal>.
    Se recomienda no utilizar la entrada del usuario en tales funciones o al menos
    verifique dicha entrada en <function>__autoload</function>.
   </para>
  </note>
  <para>
   <example>
    <title>Ejemplo de auto-carga</title>
    <para>
     Este ejemplo intenta cargar las clases <literal>MyClass1</literal>
     y <literal>MyClass2</literal> de los archivos <filename>MyClass1.php</filename>
     y <filename>MyClass2.php</filename> respectivamente.
    </para>
    <programlisting role="php">
<![CDATA[
<?php
function __autoload($class_name) {
    include $class_name . '.php';
}

$obj  = new MyClass1();
$obj2 = new MyClass2();
?>
]]>
    </programlisting>
   </example>
   <example>
    <title>Otro ejemplo de auto-carga</title>
    <para>
     Este ejemplo intenta cargar la interfaz <literal>ITest</literal>.
    </para>
    <programlisting role="php">
<![CDATA[
<?php

function __autoload($name) {
    var_dump($name);
}

class Foo implements ITest {
}

/*
string(5) "ITest"

Fatal error: Interface 'ITest' not found in ...
*/
?>
]]>
    </programlisting>
   </example>
   <example>
    <title>Auto-carga con manejo de excepciones para 5.3.0+</title>
    <para>
     Este ejemplo lanza una excepción y demuestra los bloques try/catch.
    </para>
    <programlisting role="php">
<![CDATA[
<?php
function __autoload($name) {
    echo "Intentando cargar $name.\n";
    throw new Exception("Imposible cargar $name.");
}

try {
    $obj = new NonLoadableClass();
} catch (Exception $e) {
    echo $e->getMessage(), "\n";
}
?>
]]>
    </programlisting>
    &example.outputs;
    <screen>
<![CDATA[
Intentando cargar NonLoadableClass.
Imposible cargar NonLoadableClass.
]]>
    </screen>
   </example>
   <example>
    <title>Auto-carga con manejo de excepciones para 5.3.0+ - Omitiendo excepción personalizada</title>
    <para>
     Este ejemplo lanza una excepción para una excepción personalizada no cargable.
    </para>
    <programlisting role="php">
<![CDATA[
<?php
function __autoload($name) {
    echo "Intentando cargar $name.\n";
    throw new MissingException("Imposible cargar $name.");
}

try {
    $obj = new NonLoadableClass();
} catch (Exception $e) {
    echo $e->getMessage(), "\n";
}
?>
]]>
    </programlisting>
    &example.outputs;
    <screen>
<![CDATA[
Intentando cargar NonLoadableClass.
Intentando cargar MissingException.

Fatal error: Class 'MissingException' not found in testMissingException.php on line 4
]]>
    </screen>
   </example>
  </para>

  <simplesect role="seealso">
   &reftitle.seealso;
   <para>
    <simplelist>
     <member><function>unserialize</function></member>
     <member><link linkend="unserialize-callback-func">unserialize_callback_func</link></member>
     <member><function>spl_autoload</function></member>
     <member><function>spl_autoload_register</function></member>
    </simplelist>
   </para>
  </simplesect>

 </sect1>
 
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
