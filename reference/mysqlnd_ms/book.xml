<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision$ -->
<!-- EN-Revision: 649f89731ce6c51290172e2a2e716c093097bc12 Maintainer: seros Status: ready -->
<!-- Reviewed: no -->

<book xml:id="book.mysqlnd-ms" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">
 <title>Complemento de equilibrio de carga y replicación de mysqlnd</title>
 <titleabbrev>mysqlnd_ms</titleabbrev>

 <preface xml:id="intro.mysqlnd-ms">
  &reftitle.intro;
  <para>
   El complemento de equilibrio de carga y replicación de mysqlnd (<literal>mysqlnd_ms</literal>)
   añade facilidades para usar el soporte de replicación de MySQL a todas las extensiones de MySQL de PHP que utilizan
   <link linkend="book.mysqlnd">mysqlnd</link>.
  </para>
  <para>
   A partir de la versión 5.3.3 de PHP, el controlador nativo de MySQL de PHP
   (<literal>mysqlnd</literal>)
   ofrece una API en C de complementos internos. Los complementos en C, como el complemento de
   replicación y equilibrio de carga, pueden extender la funcionalidad de
   <link linkend="book.mysqlnd">mysqlnd</link>.
  </para>
  <para>
   El controlador nativo de MySQL de PHP es una biblioteca en C que va junto con
   PHP a partir de PHP 5.3.0. Sirve como un sustituto de paso para la
   Biblioteca Cliente de MySQL (libmysql/libmysqlclient). Usar mysqlnd tiene
   varias ventajas: no es necesario descargas extra debido a que está incluido con PHP,
   está bajo la licencia de PHP, hay menor consumo de memoria en ciertos casos, y
   contiene funcionalidad nueva tal como consultas asíncronas.
  </para>
  <para>
   Los complementos de mysqlnd como <literal>mysqlnd_ms</literal> operan, en mayor parte,
   de forma transparente desde la perspectiva del usuario. El complemento de replicación y equilibrio
   de carga soporta todas las aplicaciones de PHP y todas las extensiones de MySQl de PHP.
   No cambia las APIs existentes. Por lo tanto, se puede usar fácilmente con
   las aplicaciones de PHP existentes.
  </para>
  <section xml:id="mysqlnd-ms.key-features">
   <title>Características principales</title>
   <para>
   Las características principales de PECL/mysqlnd_ms son las siguientes:
   </para>
   <para>
    <itemizedlist>
     <listitem>
      <para>
       Transparente y por lo tanto fácil de usar.
      </para>
      <para>
       <itemizedlist>
        <listitem>
         <para>
          Soporta todas las extensiones de MySQL de PHP.
         </para>
        </listitem>
        <listitem>
         <para>
          Soporte para SSL.
         </para>
        </listitem>
        <listitem>
         <para>
          Una <acronym>API</acronym> consistente.
         </para>
        </listitem>
        <listitem>
         <para>
          Se requieren pocos o ningún cambio en la aplicación, dependiendo del escenario de uso requerido.
         </para>
        </listitem>
        <listitem>
         <para>
          Conexiones lentas: las conexiones a servidores maestros y esclavos no son
          abiertas antes de que se ejecuta una sentencia SQL.
         </para>
        </listitem>
        <listitem>
         <para>
          Opcional: uso automático del maestro después de la primera escritura en una petición web, para
          disminuir el posible impacto de la demora de la replicación.
         </para>
        </listitem>
       </itemizedlist>
      </para>
     </listitem>

     <listitem>
      <para>
       Se puede usar con cualquier solución de agrupamiento (clustering) de MySQL.
      </para>
      <para>
       <itemizedlist>
        <listitem>
         <para>
          Replicación de MySQL: La división de lectura-escritura es realizada por el complemento.
          Foco primario del complemento.
         </para>
        </listitem>
        <listitem>
         <para>
          Agrupamiento de MySQL: La división de lectura-escritura se puede deshabilitar.
          Es posible la configuración de múltiples maestros
         </para>
        </listitem>
        <listitem>
         <para>
          Soluciones de terceros: el complemento está optimizado para la Replicación de MySQL
          pero se puede usar con cualquier otro tipo de solución de agrupamiento de  MySQL.
         </para>
        </listitem>
       </itemizedlist>
      </para>
     </listitem>

     <listitem>
      <para>
       Estrategias destacadas de división de lectura-escritura
      </para>
      <para>
       <itemizedlist>
        <listitem>
         <para>
          Detección automática de SELECT.
         </para>
        </listitem>
        <listitem>
         <para>
          Soporta sugerencias SQL para invalidar el automatismo.
         </para>
        </listitem>
        <listitem>
         <para>
          Definido por el usuario.
         </para>
        </listitem>
        <listitem>
         <para>
          Se puede deshabilitar, por ejemplo, al usar grupos sincrónicos tales como el Grupo MySQL.
         </para>
        </listitem>
       </itemizedlist>
      </para>
     </listitem>

     <listitem>
      <para>
       Estrategias destacadas del equilibrio de carga
      </para>
      <para>
       <itemizedlist>
        <listitem>
         <para>
          Rotación: elegir un esclavo diferente de un modo "round bobin" para cada petición a esclavos.
         </para>
        </listitem>
        <listitem>
         <para>
          Aleatoriedad: elegir un esclavo aleatorio para cada petición a esclavos.
         </para>
        </listitem>
        <listitem>
         <para>
          Aleatoiro una vez (pegajoso): elegir un esclavo aleatorio una vez para ejecutar todas las peticiones a esclavos para la duración de una petición web.
         </para>
        </listitem>
        <listitem>
         <para>
          Definido por el usuario. La aplicación puede registrar llamadas de retorno con mysqlnd_ms.
         </para>
        </listitem>
        <listitem>
         <para>
          PHP 5.4.0 o superior: consideración de transacciones al usar solamente llamadas a la API para controlar transacciones.
         </para>
        </listitem>
       </itemizedlist>
      </para>
     </listitem>

     <listitem>
      <para>
       ID de transacciones globales
      </para>
      <para>
       <itemizedlist>
        <listitem>
         <para>
          Emulación del lado del cliente. Hace más sencilla la tolerancia a fallos manual del servidor maestro y la promoción de esclavos
          con grupos asíncronos, tal como la Repliación de MySQL.
         </para>
        </listitem>
        <listitem>
         <para>
          Soporte para la característica de identificador interno de transacciones globales de MySQL 5.6.5-m8 o superior.
         </para>
        </listitem>
        <listitem>
         <para>
          Soporte del uso de IDs de transacciones para identificar esclavos asíncronos actualizados
          para lectura cuando se necesite consistencia en la sesión.
         </para>
        </listitem>
       </itemizedlist>
      </para>
     </listitem>

     <listitem>
      <para>
       Niveles de servicio y consistencia
      </para>
      <para>
       <itemizedlist>
        <listitem>
         <para>
          Las aplicaciones puede solicitar niveles de servicios eventuales, de sesión, y de
          fuerte consistencia para conexiones. Los nodos de grupos apropiados
          se buscarán automáticamente.
         </para>
        </listitem>
        <listitem>
         <para>
          Los accesos eventuales consistentes al esclavo de Replicación de MySQL pueden ser remplazados
          con accesos rápidos a la caché local de forma transparente para reducir la carga del servidor.
         </para>
        </listitem>
       </itemizedlist>
      </para>
     </listitem>
    </itemizedlist>
   </para>
  </section>

  <section xml:id="mysqlnd-ms.limitations">
   <title>Limitaciones</title>
   <para>
    El mecanismo interno de división de lectura-escritura es muy básico. Cada
    consulta que comience con <literal>SELECT</literal>
    es considerada una petición de lectura para enviarla al servidor esclavo de MySQL.
    Todas las demás consultas (como las sentencias <literal>SHOW</literal>)
    son consideradas como peticiones de escritura que son enviadas al servidor maestro de MySQL.
    El comportamiento interno se puede invalidar usando las
    <link linkend="mysqlnd-ms.constants">sugerencias SQL</link>, o una
    <link linkend="ini.mysqlnd-ms-plugin-config-v2.filter-user">función de llamada de retorno</link> definida por el usuario.
   </para>
   <para>
    El divisor de lectura-escritura no considera las sentencias múltiples. Éstas
    son consideradas como una sentencia. La decisión de dónde ejecutar la sentencia
    se basará en el inicio de la cadena de sentencia. Por ejemplo, si
    se usa <function>mysqli_multi_query</function>
    para ejecutar la sentencia múltiple <literal>SELECT id FROM test ; INSERT INTO test(id) VALUES (1)</literal>,
    la sentencia será redirigida a un servidor esclavo ya que comienza con
    <literal>SELECT</literal>. La sentencia <literal>INSERT</literal>, la cual es
    también parte de la sentencia múltiple, no será redirigida a un servidor maestro.
   </para>
   <note>
    <para>
     Las aplicaciones deben considerar las consecuencias de los cambios de conexión que se
     realizan para propósitos de equilibrio de carga. Compruebe la documentación sobre
     <link linkend="mysqlnd-ms.pooling">caché de conexiones y cambios</link>,
     <link linkend="mysqlnd-ms.transaction">transaction handling</link>,
     <link linkend="mysqlnd-ms.failover">tolerancia a fallos</link>
     <link linkend="mysqlnd-ms.loadbalancing">equilibrio de carga</link> &listendand;
     <link linkend="mysqlnd-ms.rwsplit">división de lectura-escritura</link>.
    </para>
   </note>
  </section>

  <section xml:id="mysqlnd-ms.name">
   <title>Sobre el nombre</title>
   <para>
    La abreviatura <literal>mysqlnd_ms</literal>
    significa <literal>complemento maestro esclavo de mysqlnd</literal>. El nombre
    fue elegido por una rápida y sucia prueba de concepto. Al principio,
    los desarrolladores no esperaban que se continuase usando el código base.
   </para>
  </section>
 </preface>

 &reference.mysqlnd-ms.quickstart;
 &reference.mysqlnd-ms.concepts;
 &reference.mysqlnd-ms.setup;
 &reference.mysqlnd-ms.constants;
 &reference.mysqlnd-ms.reference;
 &reference.mysqlnd-ms.changes;

</book>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
