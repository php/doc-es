<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision$ -->
<!-- EN-Revision: 59e21cf90a9cdcf8f4e841b3441bd951f24d8078 Maintainer: tardeenfamenor Status: ready -->
<!-- Reviewed: no -->
<!-- Generated by xml_proto.php v2.2. Found in /scripts directory of phpdoc. -->
<refentry xmlns="http://docbook.org/ns/docbook" xml:id="function.db2-rollback">
 <refnamediv>
  <refname>db2_rollback</refname>
  <refpurpose>
   Cancelar una transacción
  </refpurpose>
 </refnamediv>
 <refsect1 role="description">
  &reftitle.description;
  <methodsynopsis>
   <type>bool</type><methodname>db2_rollback</methodname>
   <methodparam><type>resource</type><parameter>connection</parameter></methodparam>
  </methodsynopsis>

  <para>
   Cancela una transacción en progreso en el recurso de conexión especificado
   y comienza una nueva transacción. Comunmente las aplicaciones de PHP confirman las
   transacciones de manera automática por lo que la función <function>db2_rollback</function>
   no tendría efecto a menos que este modo haya sido desactivado para este recurso.
  </para>

 </refsect1>
 <refsect1 role="parameters">
  &reftitle.parameters;
  <variablelist>
   <varlistentry>
    <term><parameter>connection</parameter></term>
    <listitem>
     <para>
      Un recurso de conexión válido devuelto por
      <function>db2_connect</function> o <function>db2_pconnect</function>.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </refsect1>
 <refsect1 role="returnvalues">
  &reftitle.returnvalues;
  <para>
   &return.success;
  </para>
 </refsect1>

 <refsect1 role="examples">
  &reftitle.examples;
  <example>
   <title>Cancelando una sentencia DELETE</title>
   <para>
    En el siguiente ejemplo se cuenta el número de filas en una tabla, se cancelan
    las confirmaciones automáticas en la conexión, se eliminan todas las filas de la tabla
    y devuelve el total de <literal>0</literal> para confirmar que las filas se han borrado.
    Cuando se llama a <function>db2_rollback</function>
    y se devuelve el total actualizado de filas en la tabla para demostrar que el número es
    igual al original (antes de ejecutar la sentancia DELETE). Esto demuestra
    que la cancelación de la transacción fue correcto.
   </para>
   <programlisting role="php">
<![CDATA[
<?php
$conn = db2_connect($database, $user, $password);

if ($conn) {
    $stmt = db2_exec($conn, "SELECT count(*) FROM animals");
    $res = db2_fetch_array( $stmt );
    echo $res[0] . "\n";

    // Turn AUTOCOMMIT off
    db2_autocommit($conn, DB2_AUTOCOMMIT_OFF);

    // Delete all rows from ANIMALS
    db2_exec($conn, "DELETE FROM animals");

    $stmt = db2_exec($conn, "SELECT count(*) FROM animals");
    $res = db2_fetch_array( $stmt );
    echo $res[0] . "\n";

    // Roll back the DELETE statement
    db2_rollback( $conn );

    $stmt = db2_exec( $conn, "SELECT count(*) FROM animals" );
    $res = db2_fetch_array( $stmt );
    echo $res[0] . "\n";
    db2_close($conn);
}
?>
]]>
   </programlisting>
   &example.outputs;
   <screen>
<![CDATA[
7
0
7
]]>
   </screen>
  </example>
 </refsect1>

 <refsect1 role="seealso">
  &reftitle.seealso;
  <simplelist>
   <member><function>db2_autocommit</function></member>
   <member><function>db2_commit</function></member>
  </simplelist>
 </refsect1>

</refentry>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
