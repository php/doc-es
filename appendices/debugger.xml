<appendix id="debugger">
 <title>El debugger de PHP</title>

 <sect1 id="debugger-using">
  <title>Usando el Debugger</title>

  <para>
   El debugger interno de PHP es útil para localizar fallos que se
   resisten. El debugger funciona conectandose a un puerto <acronym>TCP</acronym> 
   cada vez que PHP comienza. Todos los mensajes de error de esa 
   petición serán enviados a esta conexión TCP. Esta información se
   entiende que que es para un "servidor de debugger" que puede ejecutarse
   en un <acronym>IDE</acronym> o en un editor programabler (como Emacs).</para>

  <para>
   Como poner en marcha el debugger:
   <orderedlist>
    <listitem><simpara> Establezca un puerto TCP para el debugger en el <link linkend="configuration.file">archivo de configuración</link> (<link linkend="ini.debugger.port">debugger.port</link>) y activelo
      (<link linkend="ini.debugger.enabled">debugger.enabled</link>).</simpara></listitem>
      
    <listitem><simpara> Ponga en marcha un módulo de escucha de TCP en algun sitio
      (por ejemplo <command>socket -l -s 1400</command> en UNIX).</simpara></listitem>
      
    <listitem><simpara> En su código, ejecute
      "debugger_on(<replaceable>host</replaceable>)", donde
      <replaceable>host</replaceable> es la dirección IP o el nombre de el
      host ejecutando un módulo de escucha de <acronym>TCP</acronym>.</simpara></listitem>
      
   </orderedlist>

   Ahora, todos los avisos, notificaciones, etc. se mostrarán en ese módulo
   de escucha, <emphasis>incluso si lo ha desactivado con
    <function>error_reporting</function></emphasis>.</para></sect1>

 <sect1 id="debugger-protocol">
  <title>Protocolo del debugger</title>
  <para>
   El protocolo del debugger está basado en líneas. Cada línea tiene un
   <emphasis>tipo</emphasis>, y varias línea componen un
   <emphasis>mensaje</emphasis>. Cada mensaje comienza con una línea del
   tipo <literal>start</literal> y termina con una línea del 
   tipo <literal>end</literal>.  PHP puede enviar líneas para diferentes
   mensajes simultaneamente.</para>

  <para>
   Una línea tiene este formato:
   <informalexample>
    <literallayout>
<replaceable>fecha</replaceable> <replaceable>hora</replaceable> <replaceable>host</replaceable>(<replaceable>pid</replaceable>) <replaceable>tipo</replaceable>: <replaceable>datos del mensaje</replaceable>
</literallayout>
   </informalexample>
   <variablelist>
    <varlistentry>
     <term><replaceable>fecha</replaceable></term>
     <listitem>
      <simpara>Fecha en formato ISO 8601 (<replaceable>aaaa</replaceable>-<replaceable>mm</replaceable>-<replaceable>dd</replaceable>)
      </simpara>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>hora</replaceable></term>
     <listitem>
      <simpara>Hora incluyendo microsegundos:
       <replaceable>hh</replaceable>:<replaceable>mm</replaceable>:<replaceable>uuuuuu</replaceable>
      </simpara>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>host</replaceable></term>
     <listitem>
      <simpara>Nombre DNS o dirección IP del host donde el script de
      error fue generado.</simpara>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>pid</replaceable></term>
     <listitem>
      <simpara>PID (id proceso) en el <replaceable>host</replaceable> 
       del proceso en que el script de PHP generó este error.</simpara>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>tipo</replaceable></term>
     <listitem>
      <para>Tipo de la línea.  Dice al programa programa que recibe que debe
      considerar los datos siguientes como:
       <table>
	<title>Tipos de línea del debugger</title>
	<tgroup cols="2">
	 <thead>
	  <row>
	   <entry>Nombre</entry>
	   <entry>Significado</entry>
	  </row>
	 </thead>
	 <tbody>
	  <row>
	   <entry><literal>start</literal></entry> <entry>Informa al
	    programa que recibe que un mensaje del debugger comienza
	    aqui. El contenido de <replaceable>data</replaceable> será
	    el tipo del mensaje de error, listados debajo.
	   </entry>
	  </row>
	  <row>
	   <entry><literal>message</literal></entry>
	   <entry>El mensaje de error de PHP.</entry>
	  </row>
	  <row>
	   <entry><literal>location</literal></entry>
	   <entry>
	    Nombre del fichero y número de línea donde ocurrió el error.
	    La primera línea con <literal>location</literal> siempre
	    contendrá la localización de mayor nivel. <replaceable>data</replaceable>
	    contendrá
	    <literal><replaceable>fichero</replaceable>:<replaceable>línea</replaceable></literal>.
	    Siempre habrá una línea de tipo <literal>location</literal>
	    después de <literal>message</literal> y después de cada
	    <literal>function</literal>.
	   </entry>
	  </row>
	  <row>
	   <entry><literal>frames</literal></entry> <entry>Número de
	    marcos en la pila. Si hay cuatro marcos, espere información
	    sobre los cuatro niveles de las funciones llamadas. Si
	    no hay una línea de tipo "frames", la profundidad se
	    asume que es 0 (el error ocurrió en el nivel superior).
	   </entry>
	  </row>
	  <row>
	   <entry><literal>function</literal></entry> <entry>Nombre de la
	    función donde ocurrió el error. Será repetida una vez por
	    cada nivel en la pila de funciones.</entry>
	  </row>
	  <row>
	   <entry><literal>end</literal></entry> <entry>Informa al 
	   programa que recibe que el mensaje del debugger termina
	   aqui.</entry>
	  </row>
	 </tbody>
	</tgroup>
       </table>
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>data</replaceable></term>
     <listitem>
      <simpara>Línea de datos.</simpara>
     </listitem>
    </varlistentry>
   </variablelist>

   <table>
    <title>Tipos de error del debugger</title>
    <tgroup cols="2">
     <thead>
      <row>
       <entry>Debugger</entry>
       <entry>PHP Internal</entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry><errortype>warning</errortype></entry>
       <entry><errortype>E_WARNING</errortype></entry>
      </row>
      <row>
       <entry><errortype>error</errortype></entry>
       <entry><errortype>E_ERROR</errortype></entry>
      </row>
      <row>
       <entry><errortype>parse</errortype></entry>
       <entry><errortype>E_PARSE</errortype></entry>
      </row>
      <row>
       <entry><errortype>notice</errortype></entry>
       <entry><errortype>E_NOTICE</errortype></entry>
      </row>
      <row>
       <entry><errortype>core-error</errortype></entry>
       <entry><errortype>E_CORE_ERROR</errortype></entry>
      </row>
      <row>
       <entry><errortype>core-warning</errortype></entry>
       <entry><errortype>E_CORE_WARNING</errortype></entry>
      </row>
      <row>
       <entry><errortype>unknown</errortype></entry>
       <entry>(any other)</entry>
      </row>
     </tbody>
    </tgroup>
   </table>

   <example>
    <title>Ejemplo de mensaje del debugger</title>
    <literallayout>
1998-04-05 23:27:400966 lucifer.guardian.no(20481) start: notice
1998-04-05 23:27:400966 lucifer.guardian.no(20481) message: Uninitialized variable
1998-04-05 23:27:400966 lucifer.guardian.no(20481) location: (null):7
1998-04-05 23:27:400966 lucifer.guardian.no(20481) frames: 1
1998-04-05 23:27:400966 lucifer.guardian.no(20481) function: display
1998-04-05 23:27:400966 lucifer.guardian.no(20481) location: /home/ssb/public_html/test.php3:10
1998-04-05 23:27:400966 lucifer.guardian.no(20481) end: notice
</literallayout></example>

  </para>
 </sect1>

</appendix>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
