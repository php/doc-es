 <reference id="ref.mssql">
  <title>Funciones de Microsoft SQL Server</title>
  <titleabbrev>MS SQL Server</titleabbrev>

  <refentry id="function.mssql-close">
   <refnamediv>
    <refname>mssql_close</refname>
    <refpurpose>cierra una conexión con MS SQL Server</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripción</title>
    <funcsynopsis>
     <funcdef>int <function>mssql_close</function></funcdef>
     <paramdef>int <parameter>link_identifier</parameter></paramdef>
    </funcsynopsis>
    <para>Devuleve: true si se finaliza con éxito, false si se produce un error
    </para>
    <para> mssql_close() cierra la conexión con una base de datos MS SQL Server que
    está asociada al identificador especificado.  Si el identificador no se especifica,
    se asume la última conexión abierta.
    </para>
    <para> Observe que normalmente esto no es necesario, ya que las conexiones
    no-persistentes abiertas se cierran automaticamente en cuanto finaliza 
    el script.
    </para>
    <para> mssql_close() no cerrará conexiones persistentes generadas por
    mssql_pconnect().
    </para>
    <para> Ver también: <function>mssql_connect</function>,
                        <function>mssql_pconnect</function>.
    </para> 
   </refsect1>
  </refentry>

  <refentry id="function.mssql-connect">
   <refnamediv>
    <refname>mssql_connect</refname>
    <refpurpose>abre una conexión con MS SQL server</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripción</title>
    <funcsynopsis>
     <funcdef>int <function>mssql_connect</function></funcdef>
     <paramdef>string <parameter>servername</parameter></paramdef>
     <paramdef>string <parameter>username</parameter></paramdef>
     <paramdef>string <parameter>password</parameter></paramdef>
    </funcsynopsis>
    <para> Devuelve: Un identificador de MSSQL si se ejecuta correctamente, o
    false si se produce un error.
    </para>
    <para> mssql_connect() establece una conexión con MS SQL server.
    El argumento servername debe ser un nombre de servidor válido, que está definido
    en el fichero 'interfaces'.
    </para>
    <para> En caso de hacer una segunda llamada a mssql_connect() con los
    mismos argumentos, no se establecerá una nueva conexión, sino que se 
    devolverá el identificador de la conexión establecida anteriormente.
    </para>
    <para> La conexión con el servidor se cerrará tan pronto como finalice 
    el script, a menos que se cierre antes, mediante una 
    llamada explicita a la función <function>mssql_close</function>.
    </para>
    <para>Ver también <function>mssql_pconnect</function>, 
                   <function>mssql_close</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-data-seek">
   <refnamediv>
    <refname>mssql_data_seek</refname>
    <refpurpose>mueve el puntero interno de las filas</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripción</title>
    <funcsynopsis>
     <funcdef>int <function>mssql_data_seek</function></funcdef>
     <paramdef>int <parameter>result_identifier</parameter></paramdef>
     <paramdef>int <parameter>row_number</parameter></paramdef>
    </funcsynopsis>
    <para> Devuelve: true si se ejecuta con éxito, false si falla.
    </para>
    <para> mssql_data_seek() mueve el puntero interno de la consulta 
    MS SQL asociada al result_identifier especificado, para que
    apunte al número de fila especificada.  La siguiente llamada a
    <function>mssql_fetch_row</function> devolverá esa fila.
    </para>
    <para> Ver también: <function>mssql_data_seek</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-fetch-array">
   <refnamediv>
    <refname>mssql_fetch_array</refname>
    <refpurpose>Captura la fila en un array</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripción</title>
    <funcsynopsis>
     <funcdef>int <function>mssql_fetch_array</function></funcdef>
     <paramdef>int <parameter>result</parameter></paramdef>
    </funcsynopsis>
    <para> Devuelve: Un array que corresponde a la fila capturada, o
    false si no hay más filas.
    </para>
    <para>
     mssql_fetch_array() es una versión extendida de
     <function>mssql_fetch_row</function>. A¤ade el almacenar los datos
     en los índices numéricos del array resultante, también almacena
     los datos en índices asociativos, usando los nombres de los campos
     como claves.
    </para>
    <para>
     Una observación a tener en cuenta es, que usar mssql_fetch_array() NO es
     más lento que usar mssql_fetch_row(), mientras que esta
     provee un valor a¤adido significativo.</para>
    <para>
     Para más detalles, ver también
     <function>mssql_fetch_row</function>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-fetch-field">
   <refnamediv>
    <refname>mssql_fetch_field</refname>
    <refpurpose>obtiene la información de los campos</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripción</title>
    <funcsynopsis>
     <funcdef>object <function>mssql_fetch_field</function></funcdef>
     <paramdef>int <parameter>result</parameter></paramdef>
     <paramdef>int <parameter>field_offset</parameter></paramdef>
    </funcsynopsis>
    <para>
     Devuleve un objeto que contiene información de los campos.  
    </para>
    <para>
     mssql_fetch_field() se puede usar para obtener información acerca
     de los campos pertenecientes al resultado de una consulta.  Si el parámetro
     field_offset no es especificado, se devuelve la información del siguiente
     campo que todavía no ha sido devuelto por mssql_fetch_field().
    </para>
    <para>
     Las propiedades de este objeto son:
    </para>

     <itemizedlist>
      <listitem><simpara>
   name - nombre de la columna.  si la columna es el resultado de una función, esta propiedad vale #N,
   donde #N es un número de serie.
       </simpara></listitem>
      <listitem><simpara>
   column_source - la tabla de donde se tomó la columna
       </simpara></listitem>
      <listitem><simpara>
   max_length - longitud máxima de columna
       </simpara></listitem>
      <listitem><simpara>
   numeric - 1 si la columna es numérica
       </simpara></listitem> 
     </itemizedlist>

    <para>
     Ver también <function>mssql_field_seek</function>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-fetch-object">
   <refnamediv>
    <refname>mssql_fetch_object</refname>
    <refpurpose>captura la fila como un objeto</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripción</title>
    <funcsynopsis>
     <funcdef>int <function>mssql_fetch_object</function></funcdef>
     <paramdef>int <parameter>result</parameter></paramdef>
    </funcsynopsis>
    <para> Devuelve: Un objeto con propiedades que se corresponden con la
    fila capturada, o false si no hay más filas.
    </para>
    <para> mssql_fetch_object() es parecida a <function>mssql_fetch_array</function>,
    con una diferencia - devuelve un objeto en vez de un array.
    Indirectamente, esto significa que sólo se puede acceder a los datos por el
    nombre de los campos, y no por sus posiciones en el objeto
    (los números no son nombres de propiedades válidas).</para>
    <para>
    La función es idéntica a <function>mssql_fetch_array</function>, y casi
    tan rápida como <function>mssql_fetch_row</function> (la diferencia es
    insignificante).
    </para>
    <para> Ver también: <function>mssql_fetch-array</function> and
                     <function>mssql_fetch-row</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-fetch-row">
   <refnamediv>
    <refname>mssql_fetch_row</refname>
    <refpurpose>obtiene la fila como un array numerado</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripción</title>
    <funcsynopsis>
     <funcdef>array <function>mssql_fetch_row</function></funcdef>
     <paramdef>int <parameter>result</parameter></paramdef>
    </funcsynopsis>
    <para> Devuleve: Un array que corresponde a la fila capturada, o
    false si no hay más filas.
    </para>
    <para>
     mssql_fetch_row() captura una fila de datos pertenecientes al resultado
     asociado con el identificador de resultado especificado.  La fila es
     devuelta como un array.  Cada columna de resultados es almacenada en una
     posición del array, comenzando en la posición 0.
    </para>
    <para>
     Siguientes llamadas a mssql_fetch_rows() devolverían las filas siguientes
     del result set, o false si no hay mas filas.
    </para>
    <para>
     Ver también: <function>mssql_fetch_array</function>,
               <function>mssql_fetch_object</function>,
               <function>mssql_data_seek</function>,
               <function>mssql_fetch_lengths</function>, and
               <function>mssql_result</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-field-seek">
   <refnamediv>
    <refname>mssql_field_seek</refname>
    <refpurpose>set field offset</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripción</title>
    <funcsynopsis>
     <funcdef>int <function>mssql_field_seek</function></funcdef>
     <paramdef>int <parameter>result</parameter></paramdef>
     <paramdef>int <parameter>field_offset</parameter></paramdef>
    </funcsynopsis>
    <para>
     Se posiciona en el campo especificado por el parámetro field_offset.
     Si la siguiente llamada a <function>mssql_fetch_field</function> no incluye
     el parámetro field_offset, lo que devuelve la función es el campo.</para>
    <para></para>
    <para>
     Ver también: <function>mssql_fetch_field</function>.</para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-free-result">
   <refnamediv>
    <refname>mssql_free_result</refname>
    <refpurpose>libera de la memoria el resultado de una consulta</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripción</title>
    <funcsynopsis>
     <funcdef>int <function>mssql_free_result</function></funcdef>
     <paramdef>int <parameter>result</parameter></paramdef>
    </funcsynopsis>
    <para>
     <function>mssql_free_result</function> sólo se necesita llamarla
     si le preocupa el estar usando mucha memoria mientras se está ejecutando
     el script. Toda el resultado en memoria será liberado automaticamente cuando
     finalice el script, puede llamar a <function>mssql_free_result</function>
     con el identificador de la consulta como argumento y la consulta asociada
     será liberada de la memoria.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-num-fields">
   <refnamediv>
    <refname>mssql_num_fields</refname>
    <refpurpose>obtiene el número de campos de la consulta</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripción</title>
    <funcsynopsis>
     <funcdef>int <function>mssql_num_fields</function></funcdef>
     <paramdef>int <parameter>result</parameter></paramdef>
    </funcsynopsis>
    <para> mssql_num_fields() devuelve el número de campos de la consulta o
    result set.
    </para>
    <para> 
     Ver también:  
     <function>mssql_db_query</function>, 
     <function>mssql_query</function>, 
     <function>mssql_fetch_field</function>, 
     <function>mssql_num_rows</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-num-rows">
   <refnamediv>
    <refname>mssql_num_rows</refname>
    <refpurpose>obtiene el número de filas de la consulta</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripción</title>
    <funcsynopsis>
     <funcdef>int <function>mssql_num_rows</function></funcdef>
     <paramdef>string <parameter>result</parameter></paramdef>
    </funcsynopsis>
    <para>
     mssql_num_rows() devuelve el número de filas de la consulta o result set.
    </para>
    <para>
     Ver también:  
     <function>mssql_db_query</function>, 
     <function>mssql_query</function> and, 
     <function>mssql_fetch_row</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-pconnect">
   <refnamediv>
    <refname>mssql_pconnect</refname>
    <refpurpose>abre una conexión persistenete con MS SQL</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripción</title>
    <funcsynopsis>
     <funcdef>int <function>mssql_pconnect</function></funcdef>
     <paramdef>string <parameter>servername</parameter></paramdef>
     <paramdef>string <parameter>username</parameter></paramdef>
     <paramdef>string <parameter>password</parameter></paramdef>
    </funcsynopsis>
    <para> 
     Devuelve: Un identificador persistente postivo si no hay error,
     o false si se produce alguno</para>
    <para>
     mssql_pconnect() funciona de la misma forma que <function>mssql_connect</function>
     aunque con dos grandes diferencias.</para>
    <para> 
     La primera es que cuando intenta conectar, la función intentará encontrar un
     enlace (persistente) que ya esté abierto en el mismo ordenador, nombre de usuario y
     contrase¤a.  Si lo encuentra, la funcion devolverá el identificador de esta
     en vez de abrir una nueva conexión.</para>
    <para> 
     Y la segunda, la conexión con el servidor no se cerrará cuando finalice 
     la ejecución del script.  En vez de esto, el enlace permanecerá 
     abierto para un uso futuro. (<function>mssql_close</function> no cerrará
     enlaces establecidos por <literal>mssql_pconnect()</literal>).</para>
    <para> 
     Por consiguiente, este tipo de enlace es llamado 'persistente'.</para>

   </refsect1>
  </refentry>

  <refentry id="function.mssql-query">
   <refnamediv>
    <refname>mssql_query</refname>
    <refpurpose>envia una consulta MS SQL</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripción</title>
    <funcsynopsis>
     <funcdef>int <function>mssql_query</function></funcdef>
     <paramdef>string <parameter>query</parameter></paramdef>
     <paramdef>int <parameter>link_identifier</parameter></paramdef>
    </funcsynopsis>
    <para> Devuelve: Un identificado de resultado valido si no hay error, o
    false en caso contrario.
    </para>
    <para> mssql_query() envia una petición de consulta a la base de datos 
    activa en el servidor asociada al identificador de enlace especificado.
    Si el identificador del enlace no es especificado, se asume como abierto el 
    último enlace.  Si no hay ningún enlace abierto, la función intenta establecer
    un enlace como si <function>mssql_connect</function> hubiera sido llamada,
    y lo usa.
    </para>
    <para>
     Ver también:  
     <function>mssql_db_query</function>, 
     <function>mssql_select_db</function>, and 
     <function>mssql_connect</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-result">
   <refnamediv>
    <refname>mssql_result</refname>
    <refpurpose>get result data</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripción</title>
    <funcsynopsis>
     <funcdef>int <function>mssql_result</function></funcdef>
     <paramdef>int <parameter>result</parameter></paramdef>
     <paramdef>int <parameter>i</parameter></paramdef>
     <paramdef>mixed <parameter>field</parameter></paramdef>
    </funcsynopsis>
    <para> Devuelve: El contenido de la celda en la fila y posición
    del result set especificado.
    </para>
    <para>
     mssql_result() devuelve el contenido de una celda del result set.
     El parametro field puede ser la posición del campo, o el nombre del campo
     o bién nombretabla.nombrecampo.  Si el nombre de la columna ha sido renombrado
     ('select foo as bar from...'), use el alias en vez del nombre de la 
     columna.
    </para>
    <para>
     Trabajando con result sets de gran tama¤o, debería considerar el uso
     de una de las funciones que capturan una fila completa (especificadas abajo).
     Como estas funciones devuelven el contenido de múltiples celdas en una sóla
     llamada, estas son MUCHO más rápidas que mssql_result().  También,
     observe que especificar una posición númerica para el argumento field es mucho
     mas rápido que especificar el nombre de un campo o utilizar la forma
     nombretabla.nombrecampo como argumento.
    </para>
    <para>
     Alternativas recomendadas para mayor rendimiento :
     <function>mssql_fetch_row</function>, 
     <function>mssql_fetch_array</function>, y
     <function>mssql_fetch_object</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-select-db">
   <refnamediv>
    <refname>mssql_select_db</refname>
    <refpurpose>selecciona una base de datos MS SQL</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripción</title>
    <funcsynopsis>
     <funcdef>int <function>mssql_select_db</function></funcdef>
     <paramdef>string <parameter>database_name</parameter></paramdef>
     <paramdef>int <parameter>link_identifier</parameter></paramdef>
    </funcsynopsis>
    <para> Devuelve: true si todo va bién, false si se produce un error
    </para>
    <para> mssql_select_db() selecciona como base de datos activa del servidor,
    la que está asociada al identificador de enlace especificado.  Si no se 
    especifica nigún identificador, se asume el último enlace.
    Si no hay ningún enlace abierto, la función intentará establecer un enlace 
    como si se llamara a la función <function>mssql_connect</function>, y lo usa.
    </para>
    <para>
     Cada llamada a <function>mssql_query</function> será realizada sobre
     la base de datos activa.
    </para>
    <para> Ver también:
     <function>mssql_connect</function>, 
     <function>mssql_pconnect</function>, y
     <function>mssql_query</function>
    </para>
   </refsect1>
  </refentry>

</reference>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
